from matplotlib import pyplot as plt
import matplotlib.ticker as ticker
from matplotlib import rcParams,rc
from matplotlib.ticker import MultipleLocator
from matplotlib.ticker import FixedLocator,LogLocator
import numpy as np
from matplotlib.lines import Line2D
from scipy import optimize
import matplotlib.ticker as ticker

'''
def func(x,A1,A2,A3,A4,w,theta,x0):
    return A1+A2/(A3+A4*np.exp(-(x-x0)/w))**(1/theta)

def derivative_func(x1, A1, A2, A3, A4, w, theta, x0):
    h = 1e-5  # A small step size for numerical differentiation
    # Use central difference method to compute the derivative
    derivative = (func(x1 + h, A1, A2, A3, A4, w, theta, x0) - func(x1 - h, A1, A2, A3, A4, w, theta, x0)) / (2 * h)
    return derivative
'''


data0=[1.0, 0.9896900200000002, 0.9744555199999999, 0.95473962, 0.9337095600000002, 0.90415758, 0.88153768, 0.85898048, 0.8339993599999999, 0.8065461799999997, 0.7824477999999998, 0.7572579999999999, 0.7364675199999999, 0.7154416000000002, 0.6936379600000001, 0.67415748, 0.6574274399999999, 0.63897592, 0.6168526200000002, 0.5905131999999998, 0.56651834, 0.5396188199999999, 0.5207950799999999, 0.5032708600000001, 0.4857596999999999, 0.4683674, 0.45314764, 0.43994726000000006, 0.42548743999999994, 0.41223112, 0.3985117799999999, 0.38288526000000017, 0.37383832000000006, 0.3632587800000001, 0.35391245999999993, 0.34113492, 0.32226362000000003, 0.3105464600000001, 0.30259858, 0.29629753999999997, 0.2889696599999999, 0.27626161999999993, 0.2659895199999999, 0.25645325999999996, 0.24797881999999993, 0.23800887999999992, 0.22514368000000004, 0.21512829999999997, 0.20961013999999992, 0.20301814000000004, 0.19685171999999995, 0.18992602000000003, 0.18937845999999994, 0.1826305, 0.17660698, 0.18209389999999995, 0.18614189999999997, 0.18622875999999994, 0.19114966, 0.19218549999999987, 0.19132564, 0.19346048000000005, 0.19439691999999997, 0.18884908000000003, 0.18712068, 0.18389886000000008, 0.17905457999999988, 0.17678610000000003, 0.17090064, 0.16452288000000004, 0.15599507999999998, 0.14796889999999996, 0.14007927999999994, 0.12784927999999998, 0.12035291999999996, 0.11352497999999998, 0.10586322, 0.09694095999999996, 0.09258158000000001, 0.08316702000000005, 0.07388160000000002, 0.0686609, 0.06507945999999999, 0.06193302000000001, 0.06078899999999998, 0.06462161999999996, 0.06161620000000002, 0.06252485999999999, 0.06552185999999997, 0.06531638000000001, 0.06652333999999999, 0.07135324000000001, 0.07540011999999999, 0.07230392000000002, 0.06952606, 0.06598002000000001, 0.06904851999999999, 0.06709269999999998, 0.06908336, 0.06982536, 0.07135529999999995, 0.07911752, 0.08656336000000002, 0.08633928000000003, 0.08140288000000001, 0.08090207999999997, 0.0793134, 0.07261632000000001, 0.06549228, 0.060833479999999975, 0.0583757, 0.055414020000000015, 0.05272072, 0.05040233999999998, 0.04614142000000001, 0.04111699999999999, 0.03440653999999999, 0.029138399999999995, 0.02085522000000001, 0.016321939999999993, 0.013002139999999995, 0.010113479999999998, 0.0029909200000000045, 0.0041098, 0.0006145600000000129, -0.0018598599999999866, 0.0019473399999999947, 0.008275799999999995, 0.013048159999999991, 0.01572114, 0.012537879999999994, 0.0039594599999999945, -0.001541980000000004, -0.004790700000000007, -0.008891220000000009, -0.017346200000000003, -0.02634334000000002, -0.03660673999999999, -0.04439265999999998, -0.048663679999999994, -0.05330443999999998, -0.058769840000000004, -0.06086064, -0.06103769999999999, -0.06281122, -0.0660827, -0.062029080000000035, -0.05774312000000003, -0.05417965999999999, -0.05362024, -0.04656807999999999, -0.04200874000000001, -0.04253458, -0.040714520000000004, -0.037885659999999995, -0.03995604000000001, -0.04035332, -0.03840124000000002, -0.040897239999999994, -0.039332179999999994, -0.04009766000000001, -0.0436225, -0.04506145999999999, -0.04274801999999999, -0.03205414000000001, -0.026836859999999997, -0.019675979999999996, -0.008944600000000007, -0.004415099999999998, 0.0037679999999999914, 0.014088680000000004, 0.026472500000000013, 0.03397986, 0.03757919999999999, 0.04562468000000001, 0.056836600000000015, 0.06676750000000001, 0.07075134, 0.0796191, 0.0832594, 0.08529158000000002, 0.09135897999999998, 0.09337103999999996, 0.0902516, 0.087658, 0.09034943999999999, 0.09538912000000002, 0.09685792000000003, 0.09451698000000004, 0.09150922000000003, 0.09542621999999999, 0.09190331999999998, 0.08115549999999998, 0.07734166, 0.07797942, 0.07543045999999999, 0.0687651, 0.06665193999999999, 0.06766144, 0.06896437999999999]
data1=[1.0, 1.00325122, 1.0019619, 0.9979433800000004, 0.99618732, 0.9895573999999999, 0.9827523199999999, 0.9734717799999999, 0.9623770800000001, 0.9529911999999999, 0.9445722800000003, 0.9313036999999998, 0.9189596800000001, 0.9059907800000001, 0.89202758, 0.8816712200000002, 0.8718057200000002, 0.85864098, 0.8407369200000002, 0.8225472800000001, 0.8036750400000001, 0.78681864, 0.7722634999999997, 0.7556201799999998, 0.73798542, 0.7212277600000001, 0.7062823199999998, 0.69171646, 0.67491706, 0.6579937799999999, 0.6405796599999999, 0.62366144, 0.61165336, 0.59993928, 0.58649726, 0.5767762400000002, 0.5662827600000003, 0.55406734, 0.5430228599999999, 0.5356663, 0.5275765599999999, 0.5193766999999999, 0.5108151200000001, 0.49986573999999995, 0.48916260000000017, 0.4779366799999999, 0.46784260000000005, 0.45300511999999993, 0.43949898000000004, 0.43008901999999993, 0.42165026000000005, 0.41343525999999997, 0.4092587, 0.4062798, 0.40534866000000014, 0.4007038199999998, 0.39616530000000005, 0.38965724, 0.38167854, 0.37553148000000003, 0.36692937999999997, 0.3581372000000001, 0.34997665999999994, 0.34434924, 0.34134287999999996, 0.33627542, 0.327737, 0.3176498200000001, 0.30581469999999994, 0.2974023199999999, 0.2897503, 0.28196918000000004, 0.27453084000000005, 0.26356774, 0.25488454000000005, 0.24429125999999993, 0.23289783999999994, 0.22155109999999997, 0.21075110000000002, 0.20549014000000007, 0.20490062, 0.19840885999999996, 0.1941990000000001, 0.1912568, 0.1855964, 0.17874683999999996, 0.17132582, 0.16906032000000004, 0.1684119, 0.16728146000000005, 0.16683459999999997, 0.16838447999999992, 0.16857150000000004, 0.16776058000000002, 0.17014473999999996, 0.1735432, 0.17503313999999992, 0.17662176, 0.1770036, 0.17454691999999994, 0.17113085999999997, 0.17224478000000001, 0.17044250000000002, 0.17081216000000002, 0.16632664000000003, 0.16322706000000003, 0.16337836, 0.16306150000000003, 0.16384204000000005, 0.16461384000000007, 0.16837060000000004, 0.16992145999999994, 0.17149227999999997, 0.17214970000000002, 0.17409595999999997, 0.17390908000000002, 0.17622482, 0.18015298, 0.18441162, 0.18864995999999998, 0.18941239999999998, 0.18618121999999993, 0.18492633999999997, 0.18146965999999995, 0.17579228, 0.17178810000000003, 0.16830898000000005, 0.16484351999999997, 0.16251281999999997, 0.15765935999999997, 0.15589176000000002, 0.15061972, 0.14638347999999998, 0.14502311999999995, 0.14439166000000003, 0.14069882000000003, 0.13720226, 0.13050142, 0.12649444, 0.12552799999999997, 0.12473780000000001, 0.12324094000000002, 0.12217561999999998, 0.12281526000000001, 0.12019350000000002, 0.11648935999999997, 0.11302563999999998, 0.11126189999999997, 0.1077886, 0.10715651999999996, 0.10677413999999999, 0.10941803999999998, 0.10779597999999999, 0.10633800000000004, 0.10521704000000001, 0.10467497999999999, 0.10780006, 0.10863639999999998, 0.1109095, 0.11239784, 0.11380192000000004, 0.11572456000000003, 0.11748406000000006, 0.12079482000000002, 0.12460808, 0.12503382, 0.12258542000000001, 0.11888692000000001, 0.11876140000000003, 0.11857905999999996, 0.11646668000000003, 0.11230721999999999, 0.10954489999999999, 0.10322144000000004, 0.09734696000000004, 0.09133884, 0.08291067999999997, 0.07710054000000001, 0.07440832, 0.07356015999999997, 0.07120858000000001, 0.07084678000000001, 0.07227564000000002, 0.07401395999999999, 0.077146, 0.08117768, 0.08192402, 0.08390678000000001, 0.08419916000000001, 0.08353322, 0.08025978, 0.07574878000000002, 0.07384753999999999, 0.07197531999999998, 0.07057706, 0.07038344, 0.07160612, 0.06737746, 0.0659399, 0.06439096000000002]
data2=[1.0, 1.0044926599999997, 1.0057702199999996, 1.0051195800000001, 1.0022122999999998, 0.9979872000000001, 0.9925450400000001, 0.9851912599999996, 0.9749534799999999, 0.9624788599999998, 0.9506740599999999, 0.9402527800000001, 0.9299632200000002, 0.9199403799999999, 0.9085350400000002, 0.8982494200000001, 0.8898386799999998, 0.8808214600000005, 0.87361048, 0.8673644600000001, 0.8594890599999999, 0.8527555400000001, 0.8463728999999998, 0.8401189800000002, 0.8341677999999999, 0.8304598000000002, 0.8272434200000001, 0.8210372800000001, 0.8136725000000001, 0.8074234399999999, 0.8018960600000001, 0.7951818399999999, 0.7868033200000001, 0.77674802, 0.7674556199999997, 0.7583921799999999, 0.75000652, 0.7404704799999999, 0.73245716, 0.7251865399999999, 0.7178391400000003, 0.71075806, 0.70405962, 0.69663562, 0.68745572, 0.6805087800000001, 0.6741673, 0.6688602800000001, 0.6630595800000002, 0.6543756999999999, 0.6459756400000001, 0.6361803, 0.6254089199999998, 0.6139432, 0.6024058200000001, 0.5911063, 0.58053962, 0.5683106000000001, 0.5559324800000001, 0.5453444600000004, 0.5359149000000002, 0.5290692399999998, 0.5238786, 0.5187205200000001, 0.5124554799999999, 0.50585396, 0.49874537999999985, 0.4921851999999998, 0.48417183999999996, 0.4763730800000001, 0.46821667999999994, 0.45928144, 0.45104208000000007, 0.44312465999999984, 0.4337951399999999, 0.4247111799999999, 0.41506796000000007, 0.40720038000000003, 0.3993945, 0.3917611599999999, 0.38283159999999994, 0.37304357999999993, 0.36395975999999997, 0.35431591999999995, 0.34518398, 0.33662958, 0.33024178, 0.32336988, 0.31721347999999994, 0.31183523999999996, 0.3070807, 0.3027378999999999, 0.2970256599999999, 0.29314334, 0.29028629999999994, 0.28952402000000005, 0.28914646, 0.28975164, 0.28842016000000004, 0.2867186199999999, 0.28798792, 0.28792855999999994, 0.2873155, 0.28671115999999996, 0.2859587, 0.28467743999999995, 0.2838235599999999, 0.2843127, 0.28396472, 0.28306053999999997, 0.28272042, 0.27917553999999994, 0.2766898200000001, 0.2737642999999999, 0.27101938000000003, 0.26976308000000004, 0.26763398000000005, 0.2680033, 0.2688852, 0.27108726, 0.27290839999999994, 0.2775449200000001, 0.2832061, 0.28852733999999997, 0.29282474000000003, 0.2959774200000001, 0.2990527600000001, 0.30028642, 0.30209015999999994, 0.30210075999999997, 0.30216958, 0.30177574, 0.30010440000000005, 0.29906572000000003, 0.29794788, 0.29894420000000005, 0.29896224000000005, 0.29731384, 0.2954603, 0.29368462000000006, 0.29093354, 0.28783074, 0.28624548000000005, 0.28493295999999996, 0.28424007999999995, 0.28246473999999994, 0.27812204000000007, 0.27335776000000006, 0.26814416, 0.26304359999999993, 0.2586877399999999, 0.2525991000000001, 0.24644847999999997, 0.2401387, 0.23517524000000006, 0.23070161999999997, 0.22773374000000007, 0.224113, 0.22026927999999996, 0.21689841999999998, 0.21473962, 0.21192514000000004, 0.20870566000000004, 0.20570616, 0.20333469999999998, 0.20090882000000004, 0.19696119999999995, 0.19232168000000002, 0.18838227999999999, 0.18411172, 0.18035688, 0.1777503800000001, 0.17489591999999998, 0.17154651999999998, 0.16727088, 0.16338307999999993, 0.15868954000000002, 0.15419782, 0.15136925999999998, 0.14697316000000002, 0.14227260000000003, 0.14062728000000002, 0.13800674000000002, 0.13583902000000003, 0.132972, 0.12923706, 0.12596457999999996, 0.12400592000000005, 0.12262104000000001, 0.12123212000000004, 0.11923749999999998, 0.11732932000000001, 0.11452752000000002, 0.11229723999999999, 0.10979794, 0.10820052000000002, 0.10790656000000005, 0.10846708000000004, 0.10822885999999997, 0.10865101999999995]
data3=[1.0, 0.99931922, 0.9974943400000003, 0.9940240600000001, 0.9891853800000001, 0.98317564, 0.9768409000000001, 0.9708635000000001, 0.9652369799999998, 0.9615550200000001, 0.9587111199999998, 0.9550399200000002, 0.9525348800000002, 0.94983876, 0.9462339999999998, 0.9428642400000002, 0.9381817400000001, 0.9332004200000001, 0.92675586, 0.9205473400000002, 0.9129365600000001, 0.9058470599999999, 0.8993018599999998, 0.8947012799999999, 0.8895614399999999, 0.8837467999999999, 0.87707212, 0.8702180000000003, 0.8639746000000001, 0.8584903000000006, 0.8528891000000003, 0.8482569399999998, 0.8437998600000001, 0.84014058, 0.8361631399999999, 0.83253706, 0.8279144400000003, 0.8231146199999998, 0.8171986399999999, 0.8121148599999998, 0.8071783400000002, 0.80211628, 0.7969653000000001, 0.7902653599999999, 0.7833479599999998, 0.7775697599999998, 0.7720295599999999, 0.7666630000000001, 0.76154404, 0.7556394800000001, 0.7492130599999999, 0.7422824600000001, 0.7353473199999999, 0.7292994199999998, 0.7222751599999999, 0.71461698, 0.7078741600000003, 0.7019776799999999, 0.69618228, 0.6898421, 0.6827257199999999, 0.67508696, 0.6691376399999999, 0.6636607399999999, 0.65874948, 0.65417806, 0.6502252599999998, 0.6465741199999999, 0.6427846399999997, 0.6387476200000001, 0.63275344, 0.62790952, 0.6237602600000001, 0.6199800599999999, 0.6153388800000001, 0.6105429000000001, 0.60591082, 0.60288646, 0.6003723400000001, 0.5978097, 0.59518784, 0.5913407000000002, 0.5875868400000002, 0.58351502, 0.5789678200000004, 0.5750549800000001, 0.57222876, 0.5677018200000001, 0.5638346200000001, 0.56028326, 0.5559033200000001, 0.55015458, 0.5437184799999999, 0.5374792200000003, 0.53177886, 0.5259774399999999, 0.5200767799999998, 0.51432802, 0.5094205599999999, 0.5057268, 0.5010104599999999, 0.4975886199999998, 0.4947440600000001, 0.4921226000000001, 0.48839091999999995, 0.48504559999999997, 0.4808264199999999, 0.47639050000000005, 0.47139609999999993, 0.46690174000000007, 0.4628974599999999, 0.4575285199999999, 0.45231852000000006, 0.44741133999999994, 0.4412293399999999, 0.43552264000000007, 0.4312775200000001, 0.4275122400000001, 0.4236041000000001, 0.41947439999999986, 0.41611722000000007, 0.4125959999999999, 0.40903314, 0.40471181999999994, 0.3993875000000001, 0.39480526, 0.39126445999999987, 0.38841884, 0.3861927200000001, 0.3842003399999999, 0.3832717400000001, 0.3816075, 0.38062824, 0.38107720000000006, 0.3818751199999999, 0.3818019, 0.3822993999999999, 0.38125604, 0.3784035399999999, 0.37456362, 0.37113862000000003, 0.36805503999999994, 0.36522915999999994, 0.3610240799999999, 0.35614296, 0.35051316, 0.34455559999999996, 0.340204, 0.3364868599999999, 0.33285744000000006, 0.32932706, 0.32534608, 0.32035946000000004, 0.31617952000000005, 0.31295878, 0.3101249399999999, 0.30656181999999993, 0.30309706, 0.29987998000000005, 0.29674718, 0.29404088000000006, 0.29029785999999996, 0.28751332, 0.28562346, 0.28449412, 0.28344324000000004, 0.28095363999999984, 0.27806759999999997, 0.27492368, 0.2712194599999999, 0.2668299400000001, 0.26293422000000005, 0.25960396, 0.25743036, 0.25627834, 0.25605018, 0.25669796, 0.2570516199999999, 0.25755503999999996, 0.25782054000000004, 0.25813708, 0.2586246, 0.25804885999999994, 0.25652611999999997, 0.2552106, 0.25383562000000004, 0.2527312, 0.2511444000000001, 0.2507883, 0.25160955999999995, 0.2521044, 0.25246586, 0.25227572, 0.25060776000000007, 0.24894685999999996, 0.24814238000000002, 0.24737665999999994, 0.24663028000000004, 0.24603196, 0.24446526]


datas=[data0,data1,data2,data3]

x=[_*0.5 for _ in range(len(data0))]

color_list=['#1f77b4', '#ff7f0e', '#2ca02c', '#d62728', '#9467bd', '#8c564b', '#e377c2','#7f7f7f', '#bcbd22', '#17becf']
# marker_list=['o','p','s','D','v','^']
# s_list=[55,75,50,50,60,60]
rcParams["font.family"] = "Times New Roman"
rcParams["font.weight"] = "bold"
rcParams["mathtext.fontset"] = 'stix'

fig,ax=plt.subplots(figsize=(7.5, 6.5))

labels=[16000,32000,64000,128000]
tau=[16.288669096827505, 26.57031572,48.08914539,69.23970163 ]

for axis in [ 'bottom', 'left']:
    ax.spines[axis].set_linewidth(2.5)
for axis in [ 'top', 'right']:
    ax.spines[axis].set_linewidth(0)

for i in range(4):
    ax.scatter(x,datas[i],label='$N$='+str(labels[i])+' $\\tau=$'+str(round(tau[i],2)),s=10)

# Add legend to the plot
# ax.legend(handles=legend_handles, loc='best',frameon=False,fontsize='18')

# ax.yaxis.set_minor_locator(FixedLocator([k*10 for k in range(2,19)]))

# ax.yaxis.set_minor_locator(ticker.MultipleLocator(0.05))
# ax.get_yaxis().set_major_formatter(ticker.ScalarFormatter())
# ax.set_yticks([20,50,100,150])
# ax.get_yaxis().get_major_formatter().labelOnlyBase = False
# ax.set_xscale('log')
# ax.set_yscale('log')
# ax.xaxis.set_major_locator(FixedLocator([1,10]))
# ax.yaxis.set_major_locator(FixedLocator([0.1]))
# ax.set_ylim(0.1,0.27)
# ax.set_xlim(0.,0.645)
# ax.set_ylim(17.5,190)
# plt.gca().set_yticklabels(minor='off',labels=['0.12','','','','0.2','','','','0.28'])
# plt.gca().set_xticklabels(minor='off',labels=['','','1.4','','1.8'])

# ax.set_xticks([16,17,18,19,20,21,22])
ax.set_xlabel('$t \ (\sigma/U_0)$',fontsize=30)
ax.set_ylabel('$S(k,t)$',fontsize=30)
ax.set_yscale('log')
ax.tick_params(axis='both', which='major', labelsize=25)
# ax.tick_params(axis='both', which='minor', labelsize=25)
ax.tick_params(axis='both', which='minor', width=2.5,length=3.5)
ax.tick_params(axis='both', which='major', width=2.5,length=7)

ax.set_ylim(0.015,1)
ax.set_xlim(0,100)
# ax.set_xticks([0.45,0.48,0.51])
# ax.set_yticks([0.48,0.52,0.56])
ax.legend(fontsize='18',frameon=False)
# plt.legend(loc='lower left',fontsize='15',frameon=False)
plt.savefig('hh.png',dpi=300,bbox_inches='tight')
plt.show()