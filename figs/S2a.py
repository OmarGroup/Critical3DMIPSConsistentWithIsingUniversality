from matplotlib import pyplot as plt
import matplotlib.ticker as ticker
from matplotlib import rcParams,rc
from matplotlib.ticker import MultipleLocator
from matplotlib.ticker import FixedLocator,LogLocator
import numpy as np
from matplotlib.lines import Line2D
from scipy import optimize
import matplotlib.ticker as ticker



data0=[0.0008002664060001335, 0.0022331577667190593, 0.001919185396111965, 0.003902797893084908, 0.007758211127016543, 0.01114810159682807, 0.007612300649817164, 0.009354554272780594, 0.008675694248944916, 0.0036178979080551976, 0.0033775228711505124, 0.0021838082080346023, 0.003945491800197733]
data1=[0.0015117336721393185, 0.0024375120162349277, 0.003233506203040711, 0.003988910735743929, 0.005679802417057879, 0.010038107308045172, 0.008964926207017982, 0.009035157384981557, 0.010606960143425492, 0.00447224649272, 0.0028325926370423673, 0.0030871134206465214, 0.002735329511326811]
data2=[0.00220204299851086, 0.0022674661780627266, 0.0035267376550114863, 0.003423188110738138, 0.006249353618730278, 0.008256221623499056, 0.011556411061327196, 0.010252515782666574, 0.012696581327679736, 0.0042180678144618676, 0.002927967231132341, 0.002871025963048316, 0.0022850866921936335]
data3=[0.002102986620042608, 0.002242720903379983, 0.0028838673359824806, 0.0034578727630447796, 0.005134353647531434, 0.008142954080744563, 0.010803674287261002, 0.011019563392298858, 0.012073831549180198, 0.004489860623601853, 0.0028163449562093766, 0.002994820693707762, 0.0024252331478455723]


errs=[data0,data1,data2,data3]

value0=[0.36511492903135295, 0.370510244258748, 0.38242329582522433, 0.39082811548590113, 0.42016380141955895, 0.4799839396692075, 0.5958957735626873, 0.7397055169552121, 0.8232565270876785, 0.8769766182842356, 0.9061838507229304, 0.9259496995075713, 0.9384879574482768]
value1=[0.3654426597887867, 0.371080096035695, 0.38280613498511323, 0.39125819368067405, 0.4197998226310705, 0.48145626776156736, 0.5967797376378748, 0.7399625057371477, 0.8225569077858571, 0.8773370778791628, 0.9065401491781578, 0.9260712204352316, 0.9386059445167436]
value2=[0.3662186615883778, 0.37143078362020954, 0.38479186036942287, 0.39274394958480346, 0.4227273143997815, 0.48387933125950705, 0.5988394339231232, 0.7399614530384784, 0.8215746646165517, 0.8780353601784006, 0.9069968219501131, 0.9263642427333828, 0.9388479500651105]
value3=[0.36763909029377695, 0.3718170758466915, 0.3875854366410739, 0.39478890243812753, 0.4261387886572384, 0.48899519302094185, 0.6018289390613674, 0.7412540852417452, 0.8227786241502273, 0.8785010107843586, 0.907901814865452, 0.9270904963075726, 0.9397126973434593]

values=[value0,value1,value2,value3]

x=np.linspace(16,22,num=13)


color_list=['#1f77b4', '#ff7f0e', '#2ca02c', '#d62728', '#9467bd', '#8c564b', '#e377c2','#7f7f7f', '#bcbd22', '#17becf']
# marker_list=['o','p','s','D','v','^']
# s_list=[55,75,50,50,60,60]
rcParams["font.family"] = "Times New Roman"
rcParams["font.weight"] = "bold"
rcParams["mathtext.fontset"] = 'stix'

fig,ax=plt.subplots(figsize=(7.5, 6.5))

tau=[5,10,20,40]

marker_list=['o','p','s','D','v','^']
labels=[15,16,17,18,19,20]

for axis in [ 'bottom', 'left']:
    ax.spines[axis].set_linewidth(2.5)
for axis in [ 'top', 'right']:
    ax.spines[axis].set_linewidth(0)

for i in range(4):
    ax.errorbar(x,values[i],yerr=np.array(errs[i]),linestyle='--',marker=marker_list[i],mfc='w',markersize=5,linewidth=0.75,markeredgewidth=1.5,elinewidth=2,color=color_list[i],label='$n=$'+str(tau[i]),capsize=3)

# Add legend to the plot
# ax.legend(handles=legend_handles, loc='best',frameon=False,fontsize='18')

# ax.yaxis.set_minor_locator(FixedLocator([k*10 for k in range(2,19)]))


# ax.set_xticks([16,17,18,19,20,21,22])
# plt.yticks([0,0.004,0.008,0.012])
plt.xticks([16,17,18,19,20,21,22])
ax.set_xlabel('$\ell_0/\sigma$',fontsize=30)
# ax.set_ylabel('Error estimation',fontsize=30)
ax.set_ylabel('$\langle \Delta \\rho^2 \\rangle^2_L/\langle \Delta \\rho^4 \\rangle_L$',fontsize=30)
# ax.set_yscale('log')
ax.tick_params(axis='both', which='major', labelsize=25)
# ax.tick_params(axis='both', which='minor', labelsize=25)
ax.tick_params(axis='both', which='minor', width=2.5,length=3.5)
ax.tick_params(axis='both', which='major', width=2.5,length=7)

# ax.set_ylim(0.01,1)
# ax.set_xlim(0,75)
# ax.set_xticks([0.45,0.48,0.51])
# ax.set_yticks([0.48,0.52,0.56])
ax.legend(fontsize='17',frameon=False)
# plt.legend(loc='lower left',fontsize='15',frameon=False)
# plt.savefig('hh.png',dpi=600,bbox_inches='tight')
plt.show()