from matplotlib import pyplot as plt
import matplotlib.ticker as ticker
from matplotlib import rcParams,rc
from matplotlib.ticker import MultipleLocator
from matplotlib.ticker import FixedLocator,LogLocator
import numpy as np
from matplotlib.lines import Line2D
from scipy import optimize
import matplotlib.ticker as ticker


data0=[1.0, 0.9967431600000001, 0.9745114300000002, 0.9444326699999998, 0.9069455449999997, 0.87037588, 0.8334033450000001, 0.7955752049999993, 0.7620187800000003, 0.7223469199999997, 0.6836403950000001, 0.646920985, 0.612651905, 0.575167385, 0.5347035099999998, 0.4987479950000002, 0.4643511049999999, 0.4333079849999998, 0.40418407, 0.37702026999999994, 0.35329821, 0.33254780999999994, 0.311274335, 0.29195639500000004, 0.2720249800000001, 0.2523789999999999, 0.24295562000000018, 0.2293312, 0.22273048499999987, 0.21394144999999992, 0.20589781999999995, 0.20015302499999998, 0.19096141500000005, 0.17711727500000002, 0.16109889500000002, 0.14734872000000004, 0.14180565499999997, 0.13410066499999992, 0.12812193, 0.118771155, 0.10841650499999997, 0.10606593500000004, 0.10653327000000007, 0.10333798499999998, 0.09709190999999995, 0.09137739499999999, 0.08624952000000001, 0.07937850000000002, 0.073838435, 0.06551453999999998, 0.05693305500000001, 0.05268219000000003, 0.04979551499999999, 0.05000108499999999, 0.05124737500000001, 0.053386989999999995, 0.059750174999999996, 0.06483949499999998, 0.07203834500000003, 0.07804450499999999, 0.07872396499999999, 0.08054488000000004, 0.075044865, 0.06878795999999995, 0.06286067999999997, 0.061542625000000045, 0.05927273999999997, 0.05830823500000003, 0.04867396, 0.037091820000000025, 0.031754720000000014, 0.026965799999999998, 0.022054154999999978, 0.02701213500000004, 0.029139974999999995, 0.02701447999999994, 0.021445534999999974, 0.024599769999999972, 0.024510104999999983, 0.026458925000000008]
data1=[1.0, 0.9924680199999999, 0.9712632549999997, 0.9439108499999997, 0.9092484800000002, 0.8706234250000001, 0.8309145950000004, 0.7886755549999998, 0.7460733350000004, 0.7082391150000003, 0.6726937649999999, 0.6361662250000001, 0.60333815, 0.5712340799999999, 0.5321530999999999, 0.49493959500000023, 0.4605926999999999, 0.4317483750000001, 0.4052967199999999, 0.3844083449999999, 0.3679694099999999, 0.34869210500000003, 0.32637204999999997, 0.3094155950000001, 0.2927432999999999, 0.2767364150000001, 0.25775266500000016, 0.24418663999999995, 0.23056757500000016, 0.22063162500000005, 0.21017042000000008, 0.19634864500000002, 0.18358919499999993, 0.17211546500000005, 0.16108644000000003, 0.15842745500000002, 0.15649214499999997, 0.15162653500000006, 0.15279354000000006, 0.15071004999999996, 0.14982087500000002, 0.14417526, 0.13237083000000002, 0.122061675, 0.10860882999999993, 0.09668347999999995, 0.085651395, 0.07566857499999997, 0.071979625, 0.07161339500000002, 0.06723477000000001, 0.06677343500000002, 0.069813225, 0.068918725, 0.07791736, 0.08283210000000003, 0.085061985, 0.08788641000000004, 0.09129937999999999, 0.08876267500000001, 0.08459715, 0.07691052499999997, 0.07091925499999994, 0.06974853999999998, 0.065412, 0.06338747500000003, 0.06164419500000004, 0.05910500499999999, 0.04650714000000001, 0.04017611999999999, 0.03685652500000001, 0.036187515, 0.029016285000000003, 0.02072289499999999, 0.014717994999999994, 0.0077851000000000005, 0.0034588799999999953, -0.0028015200000000035, -0.009497605000000015, -0.018707984999999986]
data2=[1.0, 0.9869209600000002, 0.9637623649999999, 0.9319837350000003, 0.8956216550000005, 0.8545820449999999, 0.8115537250000002, 0.772195885, 0.73918043, 0.7047109550000004, 0.6720989749999998, 0.63917109, 0.6106933550000001, 0.57890589, 0.5527759250000003, 0.5295631349999999, 0.5086337850000002, 0.4882957199999998, 0.4687035550000002, 0.44828370999999984, 0.42754196500000013, 0.4104054150000001, 0.39052413499999994, 0.36772073500000013, 0.3471549099999999, 0.3325418049999997, 0.31859331999999996, 0.30402357000000024, 0.2853235599999998, 0.262268245, 0.23894711499999993, 0.21636466, 0.20442854000000005, 0.19206763500000004, 0.18115953500000004, 0.16929245999999998, 0.15861788, 0.14813961499999997, 0.14205642000000007, 0.13935890000000006, 0.13686765500000006, 0.13656330000000005, 0.135451855, 0.1313896099999999, 0.12804402000000004, 0.12128262999999997, 0.11788816499999993, 0.11763406000000005, 0.11628315499999997, 0.11525873500000003, 0.11061432499999999, 0.11100357999999998, 0.11252863000000002, 0.10747997999999997, 0.10510356499999995, 0.10271177499999996, 0.098527755, 0.10302827, 0.10974263999999996, 0.11079469999999991, 0.10891177499999999, 0.10481252999999999, 0.09499974500000001, 0.086442175, 0.07985533, 0.07287373500000004, 0.06722238500000001, 0.06314348, 0.058798075, 0.05026146499999999, 0.047570159999999966, 0.04538568499999998, 0.03495322, 0.030468419999999993, 0.02278151999999999, 0.016526479999999993, 0.01645298500000001, 0.01582844999999999, 0.015977945000000004, 0.018576485]
data3=[1.0, 0.9912766499999998, 0.970247225, 0.9422750999999997, 0.908113815, 0.8777648050000006, 0.8444641400000001, 0.8066363099999994, 0.7734048750000003, 0.7372795950000003, 0.7030078249999998, 0.6727542400000003, 0.6425646100000003, 0.6112641250000002, 0.5772298600000003, 0.5409783699999998, 0.5055866500000001, 0.47020674500000026, 0.44125765999999983, 0.41711417999999995, 0.39588157999999984, 0.37108465, 0.3516991999999999, 0.3333558550000001, 0.31744523, 0.30276874500000006, 0.288327845, 0.2753070450000001, 0.2615247249999999, 0.24548557, 0.22694554499999992, 0.20891159499999998, 0.192071465, 0.18090664499999995, 0.1785263249999999, 0.17292047, 0.16658215499999993, 0.16479492000000004, 0.15737479499999998, 0.15064510500000008, 0.14060949, 0.12632921000000005, 0.12219428999999993, 0.11500792000000004, 0.10763924500000002, 0.09438508500000001, 0.08444324499999997, 0.07067559000000004, 0.06045748000000002, 0.05509553499999997, 0.04815179500000001, 0.041469165, 0.03919678500000002, 0.042768275, 0.03841322, 0.03401097499999999, 0.03218185500000001, 0.028535099999999994, 0.02461736499999999, 0.027164289999999997, 0.03007926499999998, 0.03773063000000001, 0.04588445999999996, 0.05098569500000002, 0.05289711500000003, 0.05011931999999998, 0.052157665000000006, 0.05212979499999998, 0.05368881499999998, 0.05673707499999997, 0.05075618500000001, 0.04578185499999995, 0.044526459999999976, 0.04726946000000001, 0.05238447999999999, 0.058528895000000046, 0.05920917000000001, 0.05939273, 0.060419934999999994, 0.06303991000000005]
data4=[1.0, 0.9934819150000002, 0.9730395200000003, 0.95103602, 0.9232958550000007, 0.89078671, 0.8522675350000002, 0.80902581, 0.7706403600000001, 0.7313442100000002, 0.6996580699999996, 0.6601410150000001, 0.6225625000000007, 0.5857146600000004, 0.5479158499999998, 0.5114887450000003, 0.4822240349999997, 0.4479849499999997, 0.42018736000000023, 0.3922348349999998, 0.36592981500000027, 0.3452727449999999, 0.3224933949999999, 0.30222629, 0.2849090250000001, 0.26937161000000015, 0.2536711200000001, 0.2425929999999999, 0.2362096950000002, 0.22782431499999997, 0.21599954999999998, 0.20320292999999995, 0.19470163999999993, 0.18576712500000003, 0.179487755, 0.17381839, 0.171660375, 0.16622723500000006, 0.16517146500000007, 0.16545571000000006, 0.162402385, 0.15256981000000003, 0.14357705, 0.13626868500000003, 0.12778773, 0.11594491500000004, 0.1075091049999999, 0.10242424, 0.09628858, 0.08936999000000004, 0.08957462999999997, 0.08713075999999999, 0.08368294999999999, 0.08526352000000001, 0.08583261500000003, 0.08925265000000002, 0.08956443000000001, 0.08854923499999998, 0.08760839499999999, 0.08631361499999998, 0.07810519999999999, 0.07335369999999997, 0.067475415, 0.06329104500000002, 0.06107525, 0.05877056499999997, 0.05991645999999999, 0.06398710499999999, 0.06387268000000003, 0.06574248500000003, 0.06993146500000001, 0.07261180000000002, 0.07479305499999998, 0.07555463500000005, 0.077282355, 0.07736498, 0.07700541000000007, 0.07157652500000004, 0.06232552999999999, 0.05680573]
data5=[1.0, 0.9904323700000007, 0.9661144849999999, 0.9322359199999994, 0.8957661050000003, 0.85457748, 0.8155686749999996, 0.7706834550000005, 0.7215299449999997, 0.6775879149999998, 0.6354849650000002, 0.5948712050000002, 0.5563566049999998, 0.5218792750000001, 0.48621481000000044, 0.44899776, 0.41494760500000005, 0.38566789499999987, 0.3553352450000001, 0.32731393000000003, 0.2982829550000001, 0.282512865, 0.26572034999999994, 0.255990435, 0.24888968999999986, 0.24072318500000006, 0.23118626000000006, 0.2227342999999999, 0.21569515499999978, 0.20657799999999996, 0.19969675000000003, 0.19071797500000007, 0.18186398999999995, 0.17378873500000008, 0.166715505, 0.162438575, 0.15968906499999996, 0.15689730000000005, 0.15416770000000007, 0.14953526000000003, 0.14639916999999997, 0.14302710999999996, 0.13752187500000004, 0.13566836499999999, 0.132608805, 0.12850332999999994, 0.12114662999999995, 0.1195114250000001, 0.11071636500000002, 0.10539836500000004, 0.09899017000000004, 0.09701071000000006, 0.09100555000000002, 0.08773739000000007, 0.08743158500000002, 0.08872366, 0.08261405000000004, 0.07691101000000003, 0.07868963999999999, 0.07580187499999998, 0.07255018999999997, 0.07149288499999999, 0.06471813999999998, 0.056362855, 0.054015370000000014, 0.05462431500000001, 0.052974549999999995, 0.05007430999999998, 0.046119735, 0.04456712499999999, 0.03425294500000002, 0.02500325000000001, 0.014645259999999986, 0.009568185000000002, 0.006510329999999996, 0.001174685000000003, -0.0022152649999999867, -0.009615280000000006, -0.009577584999999994, -0.007067175]
data6=[1.0, 0.9890001449999997, 0.9674615649999992, 0.9358166200000005, 0.8939995799999997, 0.8520635750000003, 0.80196282, 0.7490320999999999, 0.7026068000000001, 0.6563483899999996, 0.6142576549999998, 0.5736049649999998, 0.53482669, 0.4974624049999996, 0.45968817000000023, 0.4270900800000001, 0.396898605, 0.3679451350000001, 0.34346864000000016, 0.32333953999999987, 0.3047590449999998, 0.2864859500000001, 0.2738970449999999, 0.259458425, 0.24683090499999996, 0.23431998, 0.22517865000000004, 0.21464633500000008, 0.20773058999999994, 0.20189361500000008, 0.1940293049999999, 0.19493086499999998, 0.19265977500000012, 0.18989427000000003, 0.18204682000000003, 0.17565192499999996, 0.17010331500000003, 0.16614670500000006, 0.15942570000000003, 0.14949287999999997, 0.13520643999999996, 0.12914578, 0.11597760999999998, 0.10440633500000007, 0.09540993499999993, 0.08466523500000003, 0.07159752499999998, 0.05996946, 0.056359159999999985, 0.05264217500000002, 0.051889934999999984, 0.050064249999999984, 0.04989521500000001, 0.053624965, 0.050471304999999994, 0.04313021999999999, 0.03371199499999998, 0.027766175, 0.02881712500000001, 0.029701765, 0.033363915000000015, 0.028596439999999997, 0.028960514999999982, 0.022786400000000002, 0.022182660000000017, 0.019397355000000005, 0.023341745000000004, 0.032534675, 0.03568996500000002, 0.034986474999999975, 0.03361341500000001, 0.03175300000000002, 0.022822315, 0.02085343500000001, 0.01991575999999999, 0.016322130000000008, 0.00954750499999999, 0.006440314999999999, 0.0064857200000000195, 0.004867230000000006]


datas=[data0,data1,data2,data3,data4,data5,data6]

x=[_*1 for _ in range(len(data0))]

color_list=['#1f77b4', '#ff7f0e', '#2ca02c', '#d62728', '#9467bd', '#8c564b', '#e377c2','#7f7f7f', '#bcbd22', '#17becf']
# marker_list=['o','p','s','D','v','^']
# s_list=[55,75,50,50,60,60]
rcParams["font.family"] = "Times New Roman"
rcParams["font.weight"] = "bold"
rcParams["mathtext.fontset"] = 'stix'

fig,ax=plt.subplots(figsize=(7.5, 6.5))

tau=[20.28183613,20.70305681,22.44202668,21.89683257,21.44349129,19.41392557,18.75642987]


labels=[16,17,18,19,20,21,22]
for axis in [ 'bottom', 'left']:
    ax.spines[axis].set_linewidth(2.5)
for axis in [ 'top', 'right']:
    ax.spines[axis].set_linewidth(0)

for i in range(7):
    ax.scatter(x,datas[i],label=f'$\ell_0/\sigma$={labels[i]}  $\\tau_r$={tau[i]:.2f}',s=10)

# Add legend to the plot
# ax.legend(handles=legend_handles, loc='best',frameon=False,fontsize='18')

# ax.yaxis.set_minor_locator(FixedLocator([k*10 for k in range(2,19)]))

# ax.yaxis.set_minor_locator(ticker.MultipleLocator(0.05))
# ax.get_yaxis().set_major_formatter(ticker.ScalarFormatter())
# ax.set_yticks([20,50,100,150])
# ax.get_yaxis().get_major_formatter().labelOnlyBase = False
# ax.set_xscale('log')
# ax.set_yscale('log')
# ax.xaxis.set_major_locator(FixedLocator([1,10]))
# ax.yaxis.set_major_locator(FixedLocator([0.1]))
# ax.set_ylim(0.1,0.27)
# ax.set_xlim(0.,0.645)
# ax.set_ylim(17.5,190)
# plt.gca().set_yticklabels(minor='off',labels=['0.12','','','','0.2','','','','0.28'])
# plt.gca().set_xticklabels(minor='off',labels=['','','1.4','','1.8'])

# ax.set_xticks([16,17,18,19,20,21,22])
ax.set_xlabel('$t \ (\sigma/U_0)$',fontsize=30)
ax.set_ylabel('$S(k_0,t)$',fontsize=30)
ax.set_yscale('log')
ax.tick_params(axis='both', which='major', labelsize=25)
# ax.tick_params(axis='both', which='minor', labelsize=25)
ax.tick_params(axis='both', which='minor', width=2.5,length=3.5)
ax.tick_params(axis='both', which='major', width=2.5,length=7)

ax.set_ylim(0.03,1)
ax.set_xlim(0,80)
# ax.set_xticks([0.45,0.48,0.51])
# ax.set_yticks([0.48,0.52,0.56])
ax.legend(fontsize='18',frameon=False)
# plt.legend(loc='lower left',fontsize='15',frameon=False)
plt.savefig('hh.png',dpi=600,bbox_inches='tight')
plt.show()