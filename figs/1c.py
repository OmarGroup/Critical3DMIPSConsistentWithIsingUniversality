from matplotlib import pyplot as plt
import matplotlib.ticker as ticker
from matplotlib import rcParams,rc
from matplotlib.ticker import MultipleLocator
from matplotlib.ticker import FixedLocator,LogLocator
import numpy as np
from matplotlib.lines import Line2D

y1=[0.04248442374697928, 0.046938722802325375, 0.05153321245740229, 0.06216787995216302, 0.07093377945239517, 0.08529182887566236, 0.10294788840770926, 0.12948066791407467, 0.14850298129091094, 0.17277958914544764, 0.18876120351427272, 0.2021114586262287, 0.2175627487263438]
y2=[0.0317652050439077, 0.03511558725948546, 0.038776517495045223, 0.045336845917164525, 0.055367898562604864, 0.07113640357721723, 0.09449747708036753, 0.124583243016213, 0.15185181077078802, 0.17427212021340563, 0.1913177583101941, 0.2055825432280507, 0.22075855720453968]
y3=[0.02324562746399426, 0.02570090996019121, 0.028689836955561588, 0.03312887394868585, 0.042070496934835944, 0.059095420408465625, 0.08854790536284589, 0.12442152280728036, 0.15212724126436628, 0.17462873372951315, 0.19097992020418636, 0.2065336571800948, 0.2189865881608061]
y4=[0.016113018057079403, 0.018655903329364024, 0.019805429726423948, 0.025744785694554663, 0.03378622872444352, 0.045952684884937506, 0.07406465936751043, 0.12438399461141443, 0.15227426386384108, 0.1733214759790634, 0.19274450098973167, 0.20774235839667368, 0.21798394497953968]

err1=[0.0006115966581216062, 0.0006457574642622855, 0.0006702315719759865, 0.001127127407210325, 0.001498907955000856, 0.0014029145452366901, 0.0016115000053823264, 0.0017237068787887089, 0.0019099967894344483, 0.0010828801052450258, 0.0011790634872536172, 0.001253717842525523, 0.0007818925366298042]
err2=[0.0005523377431312706, 0.0006920915095881725, 0.0008659567855889784, 0.0010796252680263308, 0.001391146268007478, 0.0017924550290504054, 0.0022472985099097967, 0.001985395503918753, 0.0015330881002465116, 0.0011293658898965924, 0.0008539993436646257, 0.001286696096134307, 0.0005888965381205474]
err3=[0.0004920909954391044, 0.0005080375411329742, 0.0009509738417415571, 0.0008684071832763552, 0.0014918166641037932, 0.002183717330962202, 0.002448899320696123, 0.002610853359601357, 0.00261789727942851, 0.0011171120099597105, 0.0008150198881005404, 0.0008887518653314002, 0.000734804580786074]
err4=[0.0004679494243382044, 0.000548474169023044, 0.0005881817672343991, 0.0011527301768234596, 0.0016824766752630978, 0.002231973694703016, 0.003120117742956866, 0.0024101536558973815, 0.0011571681826864364, 0.0009819617330979458, 0.000677355683523807, 0.000653350550557413, 0.001061522600905607]

x1=np.linspace(16,22,num=13)
y=[y1,y2,y3,y4]
err=[err1,err2,err3,err4]
marker_list=['o','D','s','^','p']
s_list=[6.5,5.5,5.5,6.5]
labels=['$N=16000$','$N=32000$','$N=64000$','$N=128000$','$0.04$','$0.05$']

color_list=['#1f77b4', '#ff7f0e', '#2ca02c', '#d62728', '#9467bd', '#8c564b', '#e377c2','#7f7f7f', '#bcbd22', '#17becf']
# marker_list=['o','p','s','D','v','^']
# s_list=[55,75,50,50,60,60]
rcParams["font.family"] = "Times New Roman"
rcParams["font.weight"] = "bold"
rcParams["mathtext.fontset"] = 'stix'

fig,ax=plt.subplots(figsize=(7.5, 6.5))

for i in range(4):
    ax.errorbar(x1,y[i],yerr=np.array(err[i]),linestyle='--',marker=marker_list[i],mfc='w',markersize=s_list[i],linewidth=0.75,markeredgewidth=1.5,elinewidth=1.5,color=color_list[i])



for axis in [ 'bottom', 'left']:
    ax.spines[axis].set_linewidth(2.5)
for axis in [ 'top', 'right']:
    ax.spines[axis].set_linewidth(0)


# ax.yaxis.set_minor_locator(FixedLocator([k*10 for k in range(2,19)]))

# ax.yaxis.set_major_locator(FixedLocator([20,50,100,150]))
# ax.get_yaxis().set_major_formatter(ticker.ScalarFormatter())
# ax.set_yticks([20,50,100,150])
# ax.get_yaxis().get_major_formatter().labelOnlyBase = False
# ax.set_yscale('log')
# ax.set_xlim(0.,0.645)
# ax.set_ylim(17.5,190)
# plt.gca().set_yticklabels(minor='off',labels=['','','','','','','','','','','','','','','','',''])
ax.set_xticks([16,17,18,19,20,21,22])
ax.set_xlabel('$\ell_0/\sigma$',fontsize=30)
ax.set_ylabel('$\phi_{\\rm liq} -\phi_{\\rm gas}$',fontsize=30)
ax.tick_params(axis='both', which='major', labelsize=25)
ax.tick_params(axis='both', which='minor', width=2.5,length=3.5)
ax.tick_params(axis='both', which='major', width=2.5,length=7)
# ax.set_xticks([0.0,0.1,0.2,0.3,0.4,0.5,0.6])


# plt.legend(loc='lower left',fontsize='15',frameon=False)
# plt.savefig('hh.png',dpi=600,bbox_inches='tight')
plt.show()